<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0,minimal-ui:ios">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>è®¡ç§‘ä¹¦æ–‹</title>
    <link rel="stylesheet" href="../static/plugins/bootstrap-3.4.1-dist/css/bootstrap.min.css" th:href="@{/plugins/bootstrap-3.4.1-dist/css/bootstrap.min.css}">
    <link href="../static/css/topBar.css" type="text/css" rel="stylesheet" th:href="@{/css/topBar.css}"/>
    <link href="../static/css/list.css" type="text/css" rel="stylesheet" th:href="@{/css/list.css}"/>
    <link href="../static/css/table.css" type="text/css" rel="stylesheet" th:href="@{/css/list.css}"/>
    <script type="text/javascript" src="../static/plugins/bootstrap-3.4.1-dist/js/jquery-3.6.0.min.js" th:src="@{/plugins/bootstrap-3.4.1-dist/js/jquery-3.6.0.min.js}"></script>
    <script type="text/javascript" src="../static/plugins/bootstrap-3.4.1-dist/js/bootstrap.min.js" th:src="@{/plugins/bootstrap-3.4.1-dist/js/jquery-3.6.0.min.js}"></script>
</head>
<body>
<!-- é¡¶éƒ¨æ  -->
<div class="topBar"><a href="index.html" th:href="@{/index}"><i class="iconfont" >&#xe61b;</i>OBMS</a></div>
<div class="jiaocai">
    <a href="#" th:href="@{#}" data-toggle="dropdown">æ•™æ</a>
    <div class="dropdown-menu">
        <div class="dropdownfont">
            <div><a href="#" th:href="@{#}">å¤§ä¸€ä¸Š</a></div>
            <div><a href="#" th:href="@{#}">å¤§ä¸€ä¸‹</a></div>
            <div><a href="#" th:href="@{#}">å¤§äºŒä¸Š</a></div>
            <div><a href="#" th:href="@{#}">å¤§äºŒä¸‹</a></div>
            <div><a href="#" th:href="@{#}">å¤§ä¸‰ä¸Š</a></div>
            <div><a href="#" th:href="@{#}">å¤§ä¸‰ä¸‹</a></div>
            <div><a href="#" th:href="@{#}">å¤§å››ä¸Š</a></div>
            <div><a href="#" th:href="@{#}">å¤§å››ä¸‹</a></div>
        </div>
    </div>
    <span>|</span>
    <a href="#" th:href="@{#}">å…¶ä»–ä¹¦ç±</a>
</div>
<!--	<div class="login">
		<a href="denglu.html" th:href="@{/toLogin}" id="denglu">ç™»å½•</a>
		<span>|</span>
		<a href="zhuce.html" th:href="@{/toRegister}" id="zhuce">æ³¨å†Œ</a>
	</div>-->
<div class="login">
    <div class="dropdown">
        <button class="btn" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
            æˆ‘çš„è´¦æˆ·
            <span class="caret"></span>
        </button>
        <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
            <div class="dropdownfont">
                <div><a href="#" th:href="@{#}">è´¦æˆ·ä¿¡æ¯</a></div>
                <div><a href="#" th:href="@{#}">ä¹¦ç±ä¿¡æ¯</a></div>
                <div><a href="#" th:href="@{#}">ä¹¦ç±åˆ†ç±»</a></div>
            </div>
        </ul>
    </div>
</div>

<!-- å†…å®¹è¯¦æƒ… -->
<!-- æ ‡é¢˜ -->
<div class="box-hd">
    <h2>ğŸ”˜å¤§ä¸€ä¹¦ç±</h2>
</div>

<div id="main">
    <table class="table">
        <tbody>
        <tr th:each="books : ${getBookByGrade1}" style="background-color: #a13e26;color: aliceblue;">
            <th th:text="${books.bname}">ä¹¦ç±åç§°</th>
            <th th:text="${books.bprice}">ä¹¦ç±ä»·æ ¼</th>
            <th th:text="${books.bpicture}">ä¹¦ç±å›¾ç‰‡</th>
        </tr>
        </tbody>
    </table>
    <nav aria-label="Page navigation">
        <ul class="pagination">
            <li id="pre">
                <a href="#" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                </a>
            </li>
        </ul>
    </nav>
</div>
</body>

<script>

    var table = document.querySelector("table")
    //æ¨¡æ‹Ÿåå°å“åº”çš„æ•°æ®
    // var json = [
    //     {
    //         "product_id": "1001",
    //         "bname": "javaæ ¸å¿ƒæŠ€æœ¯1",
    //         "bprice": "120",
    //         "imgurl": "res/productimg/1.jpeg"
    //     }, {
    //         "product_id": "1002",
    //         "bname": "javaæ ¸å¿ƒæŠ€æœ¯2",
    //         "bprice": "130",
    //         "imgurl": "res/productimg/2.jpeg"
    //     }, {
    //         "product_id": "1003",
    //         "bname": "webæŠ€æœ¯",
    //         "bprice": "100",
    //         "imgurl": "res/productimg/3.jpeg"
    //     }, {
    //         "product_id": "1004",
    //         "bname": "Mysqlå¿…çŸ¥å¿…ä¼š",
    //         "bprice": "39",
    //         "imgurl": "res/productimg/4.jpeg"
    //     }, {
    //         "product_id": "1005",
    //         "bname": "ä¸­å›½è¿‘ä»£å²",
    //         "bprice": "105",
    //         "imgurl": "res/productimg/4.jpeg"
    //     }, {
    //         "product_id": "1006",
    //         "bname": "ä¸–ç•Œå²",
    //         "bprice": "110",
    //         "imgurl": "res/productimg/1.jpeg"
    //     }, {
    //         "product_id": "1007",
    //         "bname": "é«˜ç­‰æ•°å­¦",
    //         "bprice": "50",
    //         "imgurl": "res/productimg/1.jpeg"
    //     }, {
    //         "product_id": "1008",
    //         "bname": "ç¦»æ•£æ•°å­¦",
    //         "bprice": "60",
    //         "imgurl": "res/productimg/1.jpeg"
    //     }, {
    //         "product_id": "1010",
    //         "bname": "çº¿æ€§ä»£æ•°",
    //         "bprice": "50",
    //         "imgurl": "res\\productimg/3e83c2a6-b529-4bee-8ca9-ecc868b4d6f7.jpeg"
    //     }, {
    //         "product_id": "1011",
    //         "bname": "æ•°æ®ç»“æ„",
    //         "bprice": "100",
    //         "imgurl": "res\\productimg/53dccb9f-b918-4a81-acc9-f99594992db1.jpeg"
    //     }, {
    //         "product_id": "1013",
    //         "bname": "äººå·¥æ™ºèƒ½",
    //         "bprice": "120",
    //         "imgurl": "res\\productimg/94736781-046b-4c7c-8499-bebad2542b6f.jpg"
    //     }, {
    //         "product_id": "1014",
    //         "bname": "å¤§æ•°æ®",
    //         "bprice": "120",
    //         "imgurl": "res\\productimg/f891569d-45e3-4b7f-a37e-980273f84508.jpg"
    //     }
    // ];

    var ul = document.querySelector(".pagination");
    var page_number = 5; //å•é¡µæµè§ˆçš„æ¡æ•°
    var Total_pages; //é¡µæ•°
    var liAll; //é¡µç æŒ‰é’®ä¸‹æ ‡ä¸º 1åˆ°length-2æ˜¯é¡µæ•° 0å’Œlength-1ä¸ºä¸Šä¸€é¡µå’Œä¸‹ä¸€é¡µ
    var pre; //ä¸Šä¸€é¡µ
    var next; //ä¸‹ä¸€é¡µ

    function clearTable() {
        table.innerHTML = `
        <tbody>
             <tr style="background-color: #a13e26;color: aliceblue;">
                <th>ä¹¦ç±åç§°</th>
				<th>ä¹¦ç±ä»·æ ¼</th>
				<th>ä¹¦ç±å›¾ç‰‡</th>
            </tr>
        </tbody>
        `
    }
    window.onload = function() {
        json.forEach(function(item, i) {
            var tbody = document.querySelector("tbody");
            if (i < page_number) {
                var tr = document.createElement("tr");
                tr.innerHTML = `
                            <td>${item.bname}</td>
                            <td>${item.bprice}</td>
                            <td>${item.imgurl}</td>
                            `
                tbody.appendChild(tr);
            }
        });

        var len = json.length; //æ€»è®°å½•æ¡æ•°

        Total_pages = len % page_number == 0 ? len / page_number : len / page_number + 1; //é¡µæ•°

        for (var i = 1; i <= Total_pages; i++) {
            ul.innerHTML += `
            <li  id="${i}"><a href="#">${i}</a></li>
            `
        }

        ul.innerHTML += `
                <li class="next_li">
                    <a href="#" aria-label="Next">
                        <span aria-hidden="true">&raquo;</span>
                    </a>
                </li>
        `;

        liAll = document.querySelectorAll("li");
        liAll[1].childNodes[0].style.color = "red"; //åˆå§‹ç¬¬ä¸€é¡µé¡µç æ˜¯çº¢çš„
        // console.log([liAll])
        var pagethis = 1; //å½“å‰æ˜¯ç¬¬å‡ é¡µ
        for (var i = 1; i < liAll.length - 1; i++) {
            liAll[i].onclick = function() {
                for (var j = 1; j < liAll.length - 1; j++) {
                    liAll[j].childNodes[0].style.color = "blue"
                }
                pagethis = this.id; //è·å–å½“å‰æ˜¯ç¬¬å‡ é¡µ
                liAll[pagethis].childNodes[0].style.color = "red";
                // console.log(liAll[i])
                let start; //å½“é¡µæ•°æ®çš„èµ·å§‹ä¸‹æ ‡
                let end; //å½“é¡µæ•°æ®çš„ç»“æŸä¸‹æ ‡
                if (pagethis != 1) {
                    start = (pagethis - 1) * page_number;
                    end = start + page_number;
                    if (end > json.length - 1) { //å¦‚æœå½“é¡µæ•°æ®ç»“æŸå€¼å¤§äºæ€»æ•°æ®æ¡æ•°ä¸‹æ ‡çš„å€¼åˆ™èµ‹å€¼ä¸ºæ€»æ•°æ®æ¡æ•°æœ€å¤§ä¸‹æ ‡å€¼
                        end = json.length - 1;
                    }
                } else {
                    start = 0;
                    end = page_number - 1;
                }
                // console.log("start=" + start)
                // console.log("end=" + end)
                clearTable();
                var tbody = document.querySelector("tbody");
                json.forEach(function(item, i) {

                    if (i >= start && i <= end) {
                        var tr = document.createElement("tr");
                        tr.innerHTML = `
                            <td>${item.bname}</td>
                            <td>${item.bprice}</td>
                            <td>${item.imgurl}</td>
                            `
                        tbody.appendChild(tr);
                    }
                })

            }
        }
        pre = document.querySelector("#pre") //ä¸Šä¸€é¡µ
        next = document.querySelector("#next") //ä¸‹ä¸€é¡µ
        pre.onclick = function() {
            // alert(pagethis)
            if (pagethis != 1) { //å½“å‰é¡µæ•°ä¸ç­‰äº1æ—¶æ‰§è¡Œä¸Šä¸€é¡µ
                pagethis--;
                for (var j = 1; j < liAll.length - 1; j++) {
                    liAll[j].childNodes[0].style.color = "blue"
                }
                liAll[pagethis].childNodes[0].style.color = "red";
                let start;
                let end;
                if (pagethis != 1) {
                    start = (pagethis - 1) * page_number;
                    end = start + page_number;
                    if (end > json.length - 1) {
                        end = json.length - 1;
                    }
                } else {
                    start = 0;
                    end = page_number - 1;
                }

                clearTable();
                var tbody = document.querySelector("tbody");
                json.forEach(function(item, i) {
                    if (i >= start && i <= end) {
                        var tr = document.createElement("tr");
                        tr.innerHTML = `
                            <td>${item.bname}</td>
                            <td>${item.bprice}</td>
                            <td>${item.imgurl}</td>
                            `
                        console.log(tr)
                        tbody.appendChild(tr);
                    }
                })
            }
        }
        next.onclick = function() {
            // alert(pagethis)
            if (pagethis < liAll.length - 2) { //å½“å‰é¡µæ•°å°äºæœ€åä¸€é¡µåˆ™æ‰§è¡Œä¸‹ä¸€é¡µ
                pagethis++;
                for (var j = 1; j < liAll.length - 1; j++) {
                    liAll[j].childNodes[0].style.color = "blue"
                }
                liAll[pagethis].childNodes[0].style.color = "red";
                let start;
                let end;
                if (pagethis != 1) {
                    start = (pagethis - 1) * page_number;
                    end = start + page_number;
                    if (end > json.length - 1) {
                        end = json.length - 1;
                    }
                } else {
                    start = 0;
                    end = page_number - 1;
                }

                clearTable();
                var tbody = document.querySelector("tbody");
                json.forEach(function(item, i) {
                    if (i >= start && i <= end) {
                        var tr = document.createElement("tr");
                        tr.innerHTML = `
                            <td>${item.banme}</td>
                            <td>${item.bprice}</td>
                            <td>${item.imgurl}</td>
                            `
                        console.log(tr)
                        tbody.appendChild(tr);
                    }
                })
            }
        }

    }
</script>
</html>
